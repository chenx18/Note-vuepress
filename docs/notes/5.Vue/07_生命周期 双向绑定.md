# vue 双向数据绑定、生命周期、Vue.use

## 1. vue2.x MVVM模式原理及其实现
[vue实现mvvm模式](https://www.cnblogs.com/yimuzanghua/p/8547128.html)   
[MVVM模式原理及其实现](https://segmentfault.com/a/1190000018399478#item-5) 
[vue的MVVM](https://www.cnblogs.com/pengdt/p/12046431.html)     


- vue 采用 **数据劫持** 结合 **发布者－订阅者模式** 的方式, 实现了数据层和视图层中的数据同步  
  **最核心** 的方法通过 **Object.defineProperty()** 来劫持各个属性的 setter，getter;   
  在属性对应数据改变时，发布消息给订阅者，然后触发相应的监听回调；

- 要实现mvvm的双向绑定，必须
  - 实现一个数据监听器 Observer, 才能对数据的所有属性进行监听，如果有变动可拿到最新的值并通知订阅者
  - 实现一个指令解析器 Compile, 对每个元素节点的指令进行扫描和解析，根据指令模板替换数据，以及绑定响应的更新函数
  - 实现一个 Watcher(观察者)， 作为Observer 和 Compile 的桥梁， 能够订阅并接收到每个属性变动的通知，执行指令绑定的相应回调函数，从而更新视图
  - mvvm入口函数，整合以上三者
  ![流程图](https://segmentfault.com/img/bVBQYu "流程图")

### 1.1 实现Observer
  - 利用 Obeject.defineProperty() 来监听属性变动；
  - 主要内容：observe 的数据对象进行递归遍历，包括子属性对象的属性，都加上 setter和getter。

## 2. Obejct.defineProperty
  > 在一个对象上定义一个新属性，或者修改一个对象的现有属性，并返回此对象 
  - Obejct.defineProperty(obj,prop,decriptor)
  - obj 要定义属性的对象
  - prop 要定义或修改的属性名称
  - descriptor 要定义或修改的属性描述（具体的改变方法）
  ```js
    let obj ={a: 1};
    Object.defineProperty(obj, 'b',{
      get: function(){
        // 拦截到数据
        console.log("get方法被调用");
      },
      set: function(value){
        // 改变数据的值
        console.log("set方法被调用", value);
      },
      
    })
    obj.b;   // get方法被调用
    obj.b = 123;   // set方法被调用
  ```

## 2.生命周期

1. vue有一个完整的生命周期，实例从开始创建到销毁的过程；
2. 创建前/后 -- 加载前/后 -- 更新前/后 -- 销毁前/后
3. 周期函数：
   1. beforeCreated(): 在实例创建前执行，数据未加载状态。
   2. created(): 在实例创建、数据加载后，能初始数据，DOM渲染之前
   3. beforeMount(): 虚拟DOM已创建完成，在数据渲染前最后一次更改数据
   4. mounted(): 页面、数据渲染完成，真实DOM挂载完成
   5. beforeUpdate(): 只要要么数据改变都会触发，数据更新之前，页面数据还是原来的数据，当你请求赋值一个数据的时候会执行这个周期
   6. updated(): 只要页面数据改变了都会触发，在这里操作数据很影响性能和容易死循环
   7. beforeDestroy(): 组件销毁前执行
   8. destroyed(): 销毁后执行

## Vue.use注册插件

[vue.use原理](https://www.jianshu.com/p/19ec8c73fb3e)